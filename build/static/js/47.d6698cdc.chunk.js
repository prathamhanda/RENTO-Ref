"use strict";(self.webpackChunkroomsonrent_frontend=self.webpackChunkroomsonrent_frontend||[]).push([[47],{4955:(e,s,t)=>{t.d(s,{A:()=>l});var r=t(5475),i=t(2171),a=t(9133),n=t(5043),o=t(579);const l=e=>{let{listing:s}=e;const{toggleFavorite:t}=(0,i.i)(),{user:l}=(0,a.As)(),[c,d]=(0,n.useState)(!(!l||!s.favorites)&&s.favorites.includes(l._id)),[m,g]=(0,n.useState)(!1);return(0,o.jsx)(r.N_,{to:`/listings/${s._id}`,className:"block",children:(0,o.jsxs)("div",{className:"bg-white overflow-hidden rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300",children:[(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("img",{src:s.images[0]||"/images/placeholder.jpg",alt:s.title,className:"w-full h-48 object-cover"}),(0,o.jsx)("button",{onClick:async e=>{if(e.preventDefault(),e.stopPropagation(),l){g(!0);try{await t(s._id),d(!c)}catch(r){console.error("Error toggling favorite:",r)}finally{g(!1)}}else window.location.href=`/login?redirect=/listings/${s._id}`},disabled:m,className:"absolute top-2 right-2 p-1.5 bg-white rounded-full shadow-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:c?"#FE6F61":"none",stroke:c?"none":"currentColor",className:"w-5 h-5 text-gray-600",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),(0,o.jsx)("div",{className:"absolute bottom-2 left-2",children:(0,o.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-semibold rounded-md bg-white shadow-sm",children:s.type.charAt(0).toUpperCase()+s.type.slice(1)})})]}),(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900 truncate",children:s.title}),(0,o.jsx)("p",{className:"font-semibold text-[#FE6F61]",children:(u=s.price,new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(u))})]}),(0,o.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:[s.location.name,", ",s.location.city]}),(0,o.jsxs)("div",{className:"flex flex-wrap gap-2 mt-3",children:[s.amenities.slice(0,3).map(((e,s)=>(0,o.jsx)("span",{className:"inline-block bg-gray-100 rounded-full px-2 py-0.5 text-xs text-gray-700",children:e},s))),s.amenities.length>3&&(0,o.jsxs)("span",{className:"inline-block bg-gray-100 rounded-full px-2 py-0.5 text-xs text-gray-700",children:["+",s.amenities.length-3," more"]})]})]})]})});var u}},7771:(e,s,t)=>{t.d(s,{A:()=>u});var r=t(5043),i=t(9896),a=t(9419),n=t(2023),o=t(6036),l=t(3318),c=(t(6433),t(228)),d=t.n(c),m=t(579);delete d().Icon.Default.prototype._getIconUrl,d().Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png"});const g=e=>{let{center:s}=e;const t=(0,i.ko)();return(0,r.useEffect)((()=>{s&&t.setView(s,t.getZoom())}),[s,t]),null},u=e=>{let{center:s=[12.9716,77.5946],zoom:t=14,markers:r=[],height:i="400px",className:c="",showPopup:d=!0}=e;const u=1===r.length?[r[0].coordinates.lat,r[0].coordinates.lng]:s;return(0,m.jsx)("div",{className:`w-full ${c}`,style:{height:i},children:(0,m.jsxs)(a.W,{center:u,zoom:t,style:{height:"100%",width:"100%"},scrollWheelZoom:!1,children:[(0,m.jsx)(n.e,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,m.jsx)(g,{center:u}),r.map(((e,s)=>(0,m.jsx)(o.p,{position:[e.coordinates.lat,e.coordinates.lng],children:d&&(0,m.jsx)(l.z,{children:(0,m.jsxs)("div",{children:[(0,m.jsx)("h3",{className:"font-medium",children:e.title||"Location"}),e.address&&(0,m.jsx)("p",{className:"text-sm text-gray-600",children:e.address})]})})},s)))]})})}},8584:(e,s,t)=>{t.r(s),t.d(s,{default:()=>f});var r=t(5043),i=t(5475),a=t(2171),n=t(4630),o=t(5336),l=t(4955),c=t(3216),d=t(2774),m=t(6938),g=t(1228),u=t(2746),x=t(1654),h=t(579);const p=e=>{let{variant:s="default"}=e;const[t,i]=(0,r.useState)(""),[a,o]=(0,r.useState)(!1),[l,p]=(0,r.useState)(!1),{suggestions:y,getSuggestions:f,suggestionsLoading:b,suggestionsError:j,getCurrentLocation:v}=(0,n.CR)(),w=(0,r.useRef)(null),N=(0,r.useRef)(null),k=(0,c.Zp)(),{showError:S,showInfo:C}=(0,x.h)(),P="homepage"===s;(0,r.useEffect)((()=>{t.trim().length>2?(f(t),o(!0)):o(!1)}),[t,f]),(0,r.useEffect)((()=>{const e=e=>{N.current&&!N.current.contains(e.target)&&w.current&&!w.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const F=e=>{if(e||t){k(`/search?location=${encodeURIComponent(e||t)}`),o(!1)}},L=P?"max-w-3xl w-full px-4 py-6 bg-white rounded-lg shadow-lg":"w-full md:w-auto";return(0,h.jsxs)("div",{className:L,children:[P&&(0,h.jsx)("h2",{className:"text-2xl md:text-3xl font-bold text-gray-800 mb-4",children:"Find your perfect PG accommodation"}),(0,h.jsxs)("div",{className:"relative",children:[(0,h.jsxs)("form",{onSubmit:e=>{e.preventDefault(),F()},className:"flex items-center",children:[(0,h.jsxs)("div",{className:"relative flex-grow",children:[(0,h.jsx)("input",{ref:w,type:"text",value:t,onChange:e=>i(e.target.value),placeholder:"Enter location (e.g., Koramangala, HSR Layout)",className:"w-full pl-4 pr-10 py-3 rounded-l-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(P?"text-lg":"text-base"),onFocus:()=>{t.trim().length>2&&o(!0)}}),(0,h.jsx)("button",{type:"button",onClick:async()=>{p(!0),C("Fetching your current location...");try{const e=await v();if(e.locationName){const s=e.cityName?`${e.locationName}, ${e.cityName}`:e.locationName;i(s),F(s)}else S("Could not determine your location name")}catch(e){console.error("Location error:",e),S("Unable to get your location. Please check browser permissions.")}finally{p(!1)}},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-primary-500 focus:outline-none disabled:opacity-50 "+(l?"cursor-not-allowed":"cursor-pointer"),disabled:l,title:"Use current location",children:l?(0,h.jsx)(u.A,{size:"sm",className:"text-primary-500"}):(0,h.jsx)(d.meu,{className:"h-4 w-4"})})]}),(0,h.jsxs)("button",{type:"submit",className:"bg-primary-500 hover:bg-primary-600 text-white px-6 py-3 rounded-r-lg transition-colors duration-300 flex items-center justify-center "+(P?"text-lg":"text-base"),children:[(0,h.jsx)(d.KSO,{className:P?"h-5 w-5":"h-4 w-4"}),(0,h.jsx)("span",{className:"ml-2 hidden md:inline",children:"Search"})]})]}),(0,h.jsx)(m.N,{children:a&&(0,h.jsx)(g.P.div,{ref:N,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-80 overflow-y-auto",children:b?(0,h.jsx)("div",{className:"p-4 flex justify-center",children:(0,h.jsx)(u.A,{size:"md"})}):j?(0,h.jsx)("div",{className:"p-4 text-red-500 text-center",children:j}):y.length>0?(0,h.jsx)("ul",{children:y.map((e=>(0,h.jsxs)("li",{className:"px-4 py-3 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0",onClick:()=>{const s=e.city?`${e.name}, ${e.city}`:e.name;i(s),F(s)},children:[(0,h.jsx)("div",{className:"font-medium",children:e.name}),(0,h.jsxs)("div",{className:"text-sm text-gray-500",children:[e.city,e.state?`, ${e.state}`:""]})]},e._id)))}):t.trim().length>2?(0,h.jsx)("div",{className:"p-4 text-center text-gray-500",children:"No locations found"}):null})})]})]})};var y=t(7771);const f=()=>{const[e]=(0,i.ok)(),{searchListings:s,loading:t,error:c}=(0,a.i)(),{locations:d,fetchLocations:m}=(0,n.CR)(),g=e.get("query")||"",x=e.get("location")||"",[f,b]=(0,r.useState)([]),[j,v]=(0,r.useState)(0),[w,N]=(0,r.useState)(1),[k,S]=(0,r.useState)({type:"",minPrice:"",maxPrice:"",amenities:[],sortBy:"newest"}),[C,P]=(0,r.useState)(!1),[F,L]=(0,r.useState)(!1);(0,r.useEffect)((()=>{m(),A()}),[g,x]);const A=async()=>{try{const e=await s({query:g,location:x,type:k.type,minPrice:k.minPrice,maxPrice:k.maxPrice,amenities:k.amenities,sortBy:k.sortBy,page:w});b(Array.isArray(e.listings)?e.listings:[]),v(e.total||0)}catch(e){console.error("Search error:",e),b([])}},R=(e,s)=>{S({...k,[e]:s})},$=f.map((e=>{var s,t;return{coordinates:{lat:(null===(s=e.location.coordinates)||void 0===s?void 0:s.lat)||0,lng:(null===(t=e.location.coordinates)||void 0===t?void 0:t.lng)||0},title:e.title,address:`${e.address}, ${e.location.name}`}}));return(0,h.jsx)(o.A,{children:(0,h.jsxs)("div",{className:"container mx-auto px-4 py-8 bg-gray-50 min-h-screen",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,h.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Search Results"}),(0,h.jsx)("button",{onClick:()=>L(!F),className:"bg-white text-gray-900 px-6 py-2 rounded-lg hover:bg-gray-100 transition shadow-sm border border-gray-200",children:F?"Hide Map":"Show Map"})]}),(0,h.jsxs)("div",{className:"flex flex-wrap gap-6",children:[(0,h.jsxs)("div",{className:"w-full lg:w-1/4",children:[(0,h.jsx)("div",{className:"mb-6",children:(0,h.jsx)(p,{initialQuery:g,initialLocation:x})}),(0,h.jsx)("div",{className:"md:hidden mb-4",children:(0,h.jsxs)("button",{onClick:()=>P(!C),className:"w-full flex items-center justify-center px-4 py-3 border border-gray-200 rounded-lg shadow-sm text-sm font-medium text-gray-900 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,h.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),C?"Hide Filters":"Show Filters"]})}),(0,h.jsx)("div",{className:"md:w-64 flex-shrink-0 "+(C?"block":"hidden md:block"),children:(0,h.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,h.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Filters"}),(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"PG Type"}),(0,h.jsxs)("select",{value:k.type,onChange:e=>R("type",e.target.value),className:"w-full border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,h.jsx)("option",{value:"",children:"All Types"}),["Single Room","Double Sharing","Triple Sharing","Four Sharing"].map((e=>(0,h.jsx)("option",{value:e,children:e},e)))]})]}),(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Price Range"}),(0,h.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,h.jsx)("input",{type:"number",placeholder:"Min",value:k.minPrice,onChange:e=>R("minPrice",e.target.value),className:"w-1/2 border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),(0,h.jsx)("span",{className:"text-gray-500",children:"-"}),(0,h.jsx)("input",{type:"number",placeholder:"Max",value:k.maxPrice,onChange:e=>R("maxPrice",e.target.value),className:"w-1/2 border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]}),(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Amenities"}),(0,h.jsx)("div",{className:"space-y-3 max-h-48 overflow-y-auto pr-2",children:["Wi-Fi","AC","TV","Fridge","Washing Machine","Geyser","Power Backup","Parking","Food","Security"].map((e=>(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("input",{id:`amenity-${e}`,type:"checkbox",checked:k.amenities.includes(e),onChange:()=>(e=>{const s=k.amenities.includes(e)?k.amenities.filter((s=>s!==e)):[...k.amenities,e];S({...k,amenities:s})})(e),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,h.jsx)("label",{htmlFor:`amenity-${e}`,className:"ml-3 block text-sm text-gray-900",children:e})]},e)))})]}),(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Sort By"}),(0,h.jsxs)("select",{value:k.sortBy,onChange:e=>R("sortBy",e.target.value),className:"w-full border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,h.jsx)("option",{value:"newest",children:"Newest First"}),(0,h.jsx)("option",{value:"price_low",children:"Price: Low to High"}),(0,h.jsx)("option",{value:"price_high",children:"Price: High to Low"}),(0,h.jsx)("option",{value:"rating",children:"Rating"})]})]}),(0,h.jsxs)("div",{className:"flex space-x-3",children:[(0,h.jsx)("button",{onClick:()=>{N(1),A(),window.innerWidth<768&&P(!1)},className:"flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2.5 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition",children:"Apply"}),(0,h.jsx)("button",{onClick:()=>{S({type:"",minPrice:"",maxPrice:"",amenities:[],sortBy:"newest"}),N(1),A()},className:"flex-1 border border-gray-300 text-gray-900 font-medium py-2.5 px-4 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition",children:"Reset"})]})]})})]}),(0,h.jsx)("div",{className:"flex-1",children:t?(0,h.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,h.jsx)(u.A,{size:"large"})}):c?(0,h.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:c}):(0,h.jsxs)(h.Fragment,{children:[F&&(0,h.jsx)("div",{className:"mb-6 h-[400px] rounded-lg overflow-hidden shadow-sm border border-gray-200",children:(0,h.jsx)(y.A,{markers:$})}),(0,h.jsx)("div",{className:"mb-6",children:(0,h.jsxs)("p",{className:"text-gray-900",children:["Found ",(0,h.jsx)("span",{className:"font-semibold",children:j})," listings"]})}),(0,h.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map((e=>(0,h.jsx)(l.A,{listing:e},e._id)))}),0===f.length&&(0,h.jsx)("div",{className:"text-center py-12",children:(0,h.jsx)("p",{className:"text-gray-900 text-lg",children:"No listings found matching your criteria."})})]})})]})]})})}}}]);
//# sourceMappingURL=47.d6698cdc.chunk.js.map