"use strict";(self.webpackChunkroomsonrent_frontend=self.webpackChunkroomsonrent_frontend||[]).push([[546],{2546:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var n=s(5043),a=s(2171),l=s(7760),i=s(9133),o=s(2746),r=s(6213),d=s(579);const c=()=>{const{getOwnerListings:e}=(0,a.i)(),{getOwnerBookings:t}=(0,l.B)(),{user:s}=(0,i.As)(),[c,g]=(0,n.useState)({totalListings:0,activeListings:0,totalBookings:0,pendingBookings:0,confirmedBookings:0,cancelledBookings:0,totalEarnings:0,monthlyEarnings:0}),[h,x]=(0,n.useState)([]),[m,u]=(0,n.useState)(!0),[f,b]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{u(!0);const s=await e(),n=s.filter((e=>e.isActive)),a=await t(),l=a.filter((e=>"pending"===e.status)),i=a.filter((e=>"confirmed"===e.status)),o=a.filter((e=>"cancelled"===e.status)),r=i.reduce(((e,t)=>e+t.amount),0),d=new Date,c=d.getMonth(),h=d.getFullYear(),m=i.filter((e=>{const t=new Date(e.createdAt);return t.getMonth()===c&&t.getFullYear()===h})).reduce(((e,t)=>e+t.amount),0),f=[...a].sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))).slice(0,5);g({totalListings:s.length,activeListings:n.length,totalBookings:a.length,pendingBookings:l.length,confirmedBookings:i.length,cancelledBookings:o.length,totalEarnings:r,monthlyEarnings:m}),x(f),u(!1)}catch(s){console.error("Error fetching dashboard data:",s),b("Failed to load dashboard data. Please try again."),u(!1)}})()}),[e,t]),(0,n.useEffect)((()=>{(async()=>{try{const e=await r.A.get("/api/owner/dashboard/stats");g(e.data)}catch(f){console.error("Error fetching dashboard stats:",f)}})()}),[]);return m?(0,d.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,d.jsx)(o.A,{size:"large",color:"indigo"})}):f?(0,d.jsx)("div",{className:"p-4",children:(0,d.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-6 rounded-md",children:(0,d.jsxs)("div",{className:"flex",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)("svg",{className:"h-5 w-5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,d.jsx)("div",{className:"ml-3",children:(0,d.jsx)("p",{className:"text-sm text-red-700",children:f})})]})})}):(0,d.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Dashboard"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Total Listings"}),(0,d.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:c.totalListings})]}),(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Active Bookings"}),(0,d.jsx)("p",{className:"text-3xl font-bold text-green-600",children:c.activeListings})]}),(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Total Earnings"}),(0,d.jsxs)("p",{className:"text-3xl font-bold text-purple-600",children:["$",c.totalEarnings.toFixed(2)]})]})]})]})}}}]);
//# sourceMappingURL=546.d1bb31e3.chunk.js.map