"use strict";(self.webpackChunkroomsonrent_frontend=self.webpackChunkroomsonrent_frontend||[]).push([[75],{6433:()=>{},9075:(e,s,i)=>{i.r(s),i.d(s,{default:()=>m});var t=i(5043),r=i(3216),a=i(2171),o=i(4630),l=i(2746),n=(i(6433),i(579));i(8022);const c=["Wi-Fi","TV","Air Conditioning","Washing Machine","Refrigerator","Microwave","Gas Connection","Parking","Power Backup","Security","CCTV","Gym","Swimming Pool","Study Room","Housekeeping"],d=["No Smoking","No Pets","No Parties","No Visitors after 10pm","ID Proof Required","No Alcohol","Vegetarian Only","No Non-Veg Cooking"],m=()=>{const{id:e}=(0,r.g)(),s=(0,r.Zp)(),{createListing:i,updateListing:m,getListingById:g,loading:x,error:u}=(0,a.i)(),{getAllLocations:p,getCurrentLocation:h,showError:y}=(0,o.CR)(),[b,f]=(0,t.useState)({title:"",description:"",type:"single",price:"",securityDeposit:"",address:"",location:"",availableFrom:"",occupancy:"single",maxOccupancy:1,amenities:[],rules:[],images:[],isActive:!0}),[j,v]=(0,t.useState)([]),[N,w]=(0,t.useState)(!1),[k,S]=(0,t.useState)({}),[F,C]=(0,t.useState)(!1),[D,L]=(0,t.useState)(!!e),[A,I]=(0,t.useState)(null),[O,P]=(0,t.useState)([]),[q,M]=(0,t.useState)([]),[T,E]=(0,t.useState)(0),[R,B]=(0,t.useState)(null);(0,t.useEffect)((()=>{(async()=>{try{const i=await p();if(v(i),e){w(!0);const i=await g(e),t={...i,price:String(i.price),securityDeposit:String(i.securityDeposit),availableFrom:(s=i.availableFrom,new Date(s).toISOString().split("T")[0]),maxOccupancy:i.maxOccupancy||1,location:i.location._id};f(t),M(i.images||[]),L(!1)}}catch(i){console.error("Error loading initial data:",i),I("Failed to load form data. Please try again."),L(!1)}var s})()}),[e,p,g]);const V=e=>{const{name:s,value:i,type:t,checked:r}=e.target;if(k[s]&&S({...k,[s]:""}),"amenities"===s||"rules"===s){const e=[...b[s]];if(r)e.push(i);else{const s=e.indexOf(i);s>-1&&e.splice(s,1)}f({...b,[s]:e})}else if("checkbox"===t)f({...b,[s]:r});else if("price"===s||"securityDeposit"===s||"maxOccupancy"===s){(""===i||/^[0-9]*$/.test(i))&&f({...b,[s]:i})}else f({...b,[s]:i})};return D?(0,n.jsx)("div",{className:"flex justify-center items-center h-full p-8",children:(0,n.jsx)(l.A,{size:"large",color:"indigo"})}):(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,n.jsxs)("div",{className:"bg-white shadow-sm rounded-lg p-8 border border-gray-200",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:N?"Edit Listing":"Create New Listing"}),(0,n.jsxs)("p",{className:"mt-2 text-gray-600",children:["Fill in the details below to ",N?"update your":"create a new"," listing."]})]}),A&&(0,n.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:A}),(0,n.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),!R)return void y("Please select a location for your listing");if(!(()=>{const e={};return b.title.trim()||(e.title="Title is required"),b.description.trim()||(e.description="Description is required"),b.price||(e.price="Price is required"),b.securityDeposit||(e.securityDeposit="Security deposit is required"),b.address.trim()||(e.address="Address is required"),b.location||(e.location="Location is required"),b.availableFrom||(e.availableFrom="Available date is required"),b.title.length>100&&(e.title="Title cannot exceed 100 characters"),b.description.length>2e3&&(e.description="Description cannot exceed 2000 characters"),parseInt(b.price)<=0&&(e.price="Price must be greater than 0"),parseInt(b.securityDeposit)<0&&(e.securityDeposit="Security deposit cannot be negative"),parseInt(b.maxOccupancy)<=0&&(e.maxOccupancy="Maximum occupancy must be at least 1"),N||0!==O.length||(e.images="At least one image is required"),S(e),0===Object.keys(e).length})()){const e=document.querySelector(".text-red-600");return void(e&&e.scrollIntoView({behavior:"smooth",block:"center"}))}C(!0);const r={...b,price:parseInt(b.price),securityDeposit:parseInt(b.securityDeposit),maxOccupancy:parseInt(b.maxOccupancy),location:R._id,address:R.address,coordinates:R.coordinates,availableFrom:new Date(b.availableFrom).toISOString()};try{N?(await m(e,r,O,(e=>{E(e)})),s("/dashboard/listings")):(await i(r,O,(e=>{E(e)})),s("/dashboard/listings"))}catch(a){console.error("Error saving listing:",a),window.scrollTo(0,0)}finally{C(!1)}},className:"space-y-8",children:[(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Basic Information"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-900",children:"Title*"}),(0,n.jsx)("input",{type:"text",id:"title",name:"title",value:b.title,onChange:V,className:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter listing title"}),k.title&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.title})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-900",children:"Type*"}),(0,n.jsxs)("select",{id:"type",name:"type",value:b.type,onChange:V,className:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,n.jsx)("option",{value:"single",children:"Single Room"}),(0,n.jsx)("option",{value:"double",children:"Double Sharing"}),(0,n.jsx)("option",{value:"triple",children:"Triple Sharing"}),(0,n.jsx)("option",{value:"four",children:"Four Sharing"})]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-900",children:"Description*"}),(0,n.jsx)("textarea",{id:"description",name:"description",rows:4,value:b.description,onChange:V,className:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Describe your listing"}),k.description&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.description})]})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Location"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-900",children:"Area*"}),(0,n.jsxs)("select",{id:"location",name:"location",value:b.location,onChange:V,className:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,n.jsx)("option",{value:"",children:"Select an area"}),j.map((e=>(0,n.jsx)("option",{value:e._id,children:e.name},e._id)))]}),k.location&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.location})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-900",children:"Address*"}),(0,n.jsx)("input",{type:"text",id:"address",name:"address",value:b.address,onChange:V,className:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter complete address"}),k.address&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.address})]})]})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Pricing & Availability"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-900",children:"Monthly Rent (\u20b9)*"}),(0,n.jsx)("input",{type:"number",id:"price",name:"price",value:b.price,onChange:V,className:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter monthly rent"}),k.price&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.price})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"securityDeposit",className:"block text-sm font-medium text-gray-900",children:"Security Deposit (\u20b9)*"}),(0,n.jsx)("input",{type:"number",id:"securityDeposit",name:"securityDeposit",value:b.securityDeposit,onChange:V,className:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter security deposit"}),k.securityDeposit&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.securityDeposit})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"availableFrom",className:"block text-sm font-medium text-gray-900",children:"Available From*"}),(0,n.jsx)("input",{type:"date",id:"availableFrom",name:"availableFrom",value:b.availableFrom,onChange:V,min:(new Date).toISOString().split("T")[0],className:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm py-2.5 px-3 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),k.availableFrom&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.availableFrom})]})]})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Amenities"}),(0,n.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:c.map((e=>(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",id:`amenity-${e}`,name:"amenities",value:e,checked:b.amenities.includes(e),onChange:V,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,n.jsx)("label",{htmlFor:`amenity-${e}`,className:"ml-3 text-sm text-gray-900",children:e})]},e)))})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"House Rules"}),(0,n.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:d.map((e=>(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",id:`rule-${e}`,name:"rules",value:e,checked:b.rules.includes(e),onChange:V,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,n.jsx)("label",{htmlFor:`rule-${e}`,className:"ml-3 text-sm text-gray-900",children:e})]},e)))})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Images"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,n.jsxs)("label",{htmlFor:"images",className:"flex items-center justify-center px-6 py-4 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer hover:border-indigo-500 transition-colors",children:[(0,n.jsxs)("div",{className:"space-y-1 text-center",children:[(0,n.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:(0,n.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,n.jsx)("span",{className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Upload images"})," or drag and drop"]}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]}),(0,n.jsx)("input",{id:"images",name:"images",type:"file",multiple:!0,accept:"image/*",onChange:e=>{e.preventDefault();const s=Array.from(e.target.files);P((e=>[...e,...s]));const i=s.map((e=>URL.createObjectURL(e)));M((e=>[...e,...i]))},className:"sr-only"})]}),T>0&&(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-40 bg-gray-200 rounded-full h-2.5",children:(0,n.jsx)("div",{className:"bg-indigo-600 h-2.5 rounded-full",style:{width:`${T}%`}})}),(0,n.jsxs)("span",{className:"text-sm text-gray-600",children:[T,"%"]})]})]}),k.images&&(0,n.jsx)("p",{className:"text-sm text-red-600",children:k.images}),q.length>0&&(0,n.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mt-4",children:q.map(((e,s)=>(0,n.jsxs)("div",{className:"relative group",children:[(0,n.jsx)("div",{className:"aspect-w-16 aspect-h-9",children:(0,n.jsx)("img",{src:e,alt:`Preview ${s+1}`,className:"object-cover rounded-lg"})}),(0,n.jsx)("button",{type:"button",onClick:()=>(e=>{if(M((s=>s.filter(((s,i)=>i!==e)))),O[e])P((s=>s.filter(((s,i)=>i!==e))));else if(N){const s=[...b.images];s.splice(e,1),f({...b,images:s})}})(s),className:"absolute top-2 right-2 p-1.5 bg-red-100 rounded-full text-red-600 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},s)))})]})]}),(0,n.jsx)("div",{className:"pt-6",children:(0,n.jsx)("button",{type:"submit",disabled:F,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition",children:F?(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),N?"Updating...":"Creating..."]}):N?"Update Listing":"Create Listing"})})]})]})})})}}}]);
//# sourceMappingURL=75.91c4585d.chunk.js.map